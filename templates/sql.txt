Триггер для обновления дюратион

CREATE OR REPLACE FUNCTION calculate_duration()
RETURNS TRIGGER AS $$
BEGIN
    NEW.duration := NEW.end_date - NEW.start_date;

    IF NEW.duration = 0 THEN
        NEW.duration := 1;
    END IF;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER calculate_duration_trigger
BEFORE INSERT ON Sick_Leaves3
FOR EACH ROW
EXECUTE FUNCTION calculate_duration();